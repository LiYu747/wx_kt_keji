(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/residence/checkIn/checkIn"],{5941:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t("db9d")),a=s(t("a6bb")),o=(s(t("9381")),s(t("78ac"))),l=s(t("8031"));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){Promise.all([t.e("common/vendor"),t.e("components/lb-picker/index")]).then(function(){return resolve(t("3ee2"))}.bind(null,t)).catch(t.oe)},r=function(){t.e("components/sub-unit/subunit").then(function(){return resolve(t("e864"))}.bind(null,t)).catch(t.oe)},u=function(){t.e("components/checkIn/enclosure/enclosure").then(function(){return resolve(t("fcd5"))}.bind(null,t)).catch(t.oe)},d=function(){t.e("components/checkIn/remarks/remarks").then(function(){return resolve(t("5b4f"))}.bind(null,t)).catch(t.oe)},f={name:"",components:{subunit:r,enclosure:u,remarks:d,LbPicker:c},props:{},data:function(){return{value:[],options:[{value:"1",label:"户主"},{value:"2",label:"家庭成员"},{value:"3",label:"租户"}],record:[{label:"姓名",value:"",required:!0,disabled:!0},{label:"手机号",value:"",required:!0,disabled:!0},{label:"身份证号",value:"",required:!0,disabled:!0},{label:"入住身份",value:"",placeholder:"请选择",required:!0,disabled:!0},{label:"地址",value:"",placeholder:"请选择",required:!0,disabled:!0}],iSidentity:!1,show:!1,orgVillageLists:[],renderVillageLists:[],id:[],household:"",files:[]}},methods:{Application:function(){e.navigateTo({url:"/pages/residence/checkRecord/checkRecord"})},selectOne:function(e){this.record[3].value=e.label,this.household=e.value,this.iSidentity=!0},goback:function(){e.navigateBack({delta:1})},Onshow:function(e){e==this.record.length-2&&(this.iSidentity=!this.iSidentity),e==this.record.length-1&&(this.show=!0)},confirm:function(e){var n="",t=[],i=[];e.map((function(e){i.push(e.extra),null!=e.label&&(n+=e.label),null==e.value&&e.value,t.push(e.value)})),this.id=i,this.value=t,this.record.map((function(e,t){4===t&&(e.value=n)}))},add:function(e){this.files=e},Submit:function(){if(1!=this.$refs.encl.isLoding)if(""!=this.household)if(0!=this.id.length){e.showLoading({title:"提交中..."});var n=this.$refs.marks.value;a.default.moveInApply({data:{type:this.household,villageId:this.id[0],buildingId:this.id[1],apartmentId:this.id[2],floorId:this.id[3],roomId:this.id[4],user_remark:n,files:this.files},fail:function(n){e.hideLoading(),e.showToast({title:"网络错误",icon:"none"})},success:function(n){if(e.hideLoading(),200==n.statusCode)if(200==n.data.code){e.showToast({title:n.data.msg,duration:2e3});var t=setTimeout((function(){e.redirectTo({url:"/pages/residence/checkRecord/checkRecord"}),clearTimeout(t)}),2e3)}else e.showToast({title:n.data.msg,icon:"none"});else e.showToast({title:"网络请求出错",icon:"none"})}})}else e.showToast({title:"请选择地址",icon:"none"});else e.showToast({title:"请选择住户类型",icon:"none"})},loadVillageLists:function(){var n=this;i.default.selectLists({data:{},fail:function(n){e.showToast({title:"网络错误",icon:"none"})},success:function(e){200==e.statusCode&&200==e.data.code&&(n.orgVillageLists=e.data.data,n.renderMSelect())}})},renderMSelect:function(){if(this.orgVillageLists&&0!=this.orgVillageLists.length){var e=[];this.orgVillageLists.forEach((function(n,t){var i={label:n.name,value:t,extra:n.id,children:[]};if(!n.buildings)return!0;n.buildings.forEach((function(e,n){var t={label:e.name,value:n,extra:e.id,children:[]};if(!e.apartments)return!0;e.apartments.forEach((function(e,n){var i={label:e.name,value:n,extra:e.id,children:[]};if(!e.floors)return!0;e.floors.forEach((function(e,n){var t={label:e.name,value:n,extra:e.id,children:[]};if(!e.rooms)return!0;e.rooms.forEach((function(e,n){t.children.push({label:e.room_number,value:n,extra:e.id})})),i.children.push(t)})),t.children.push(i)})),i.children.push(t)})),e.push(i)})),this.renderVillageLists=e}else this.renderVillageLists=[]},loadUserData:function(){var n=this;l.default.doOnlyTokenValid({showModal:!0,keepSuccess:!1,success:function(){o.default.userDeta({data:{},fail:function(){e.showToast({title:"网络错误",icon:"none"})},success:function(t){if(200==t.statusCode&&200==t.data.code){var i=t.data.data;n.record[0].value=i.username,n.record[1].value=i.tel.slice(0,3)+"****"+i.tel.slice(7,11),i.id_card_no?n.record[2].value=i.id_card_no.slice(0,3)+"**********"+i.id_card_no.slice(i.id_card_no.length-4,i.id_card_no.length):e.showModal({content:"请完善您的身份信息",success:function(n){n.confirm?e.navigateTo({url:"/pages/user/realInformation/realInformation"}):n.cancel&&e.navigateBack({delta:1})}})}}})},fail:function(){e.switchTab({url:"/pages/index/index"})}})}},mounted:function(){this.loadVillageLists()},onShow:function(){this.loadUserData()},onLoad:function(){},filters:{},computed:{},watch:{},directives:{}};n.default=f}).call(this,t("543d")["default"])},"5b1f":function(e,n,t){},7704:function(e,n,t){"use strict";(function(e){t("d774");i(t("66fd"));var n=i(t("c2df"));function i(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},"788a":function(e,n,t){"use strict";var i=t("5b1f"),a=t.n(i);a.a},"8e44":function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){return i}));var i={uField:function(){return t.e("uview-ui/components/u-field/u-field").then(t.bind(null,"fb1c"))},uSelect:function(){return t.e("uview-ui/components/u-select/u-select").then(t.bind(null,"1ce0"))}},a=function(){var e=this,n=e.$createElement;e._self._c},o=[]},a99d:function(e,n,t){"use strict";t.r(n);var i=t("5941"),a=t.n(i);for(var o in i)"default"!==o&&function(e){t.d(n,e,(function(){return i[e]}))}(o);n["default"]=a.a},c2df:function(e,n,t){"use strict";t.r(n);var i=t("8e44"),a=t("a99d");for(var o in a)"default"!==o&&function(e){t.d(n,e,(function(){return a[e]}))}(o);t("788a");var l,s=t("f0c5"),c=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"ea1837e8",null,!1,i["a"],l);n["default"]=c.exports}},[["7704","common/runtime","common/vendor"]]]);